/*
 * This file was generated by the Gradle 'init' task.
 *
 * This is a general purpose Gradle build.
 * Learn how to create Gradle builds at https://guides.gradle.org/creating-new-gradle-builds/
 */

import org.gradle.plugins.ide.eclipse.model.Facet

subprojects({
    ext({
        // springLoadedVersion = '1.2.8.RELEASE'
        // jstWebVersion = '3.1'
        // embedTomcatVersion = '9.0.7'
    })

    buildscript({
        dependencies({
            classpath("org.springframework:springloaded:$springLoadedVersion")
           })
    })

    //apply(plugin: 'war')
    apply(plugin: 'spring-boot')
    apply(plugin: 'eclipse-wtp')
    
    dependencies({
        // spring boot
        runtime("org.apache.tomcat.embed:tomcat-embed-jasper:$embedTomcatVersion")
    })
    
    //Web项目设置
    eclipse({
        wtp({
            facet({
                facet(name: 'jst.java', type: Facet.FacetType.fixed)
                facet(name: 'jst.web', type: Facet.FacetType.fixed)
                facet(name: 'jst.java', version: javaVersion)
                facet(name: 'jst.web', version: jstWebVersion)
            })
        })
    })

    //定义项目目录结构
    def dirs = [new File("$projectDir/src/main/java"),
                new File("$projectDir/src/main/resources/config"),
                new File("$projectDir/src/main/resources/static"),
                new File("$projectDir/src/main/resources/templates"),
                new File("$projectDir/src/test/java"),
                new File("$projectDir/src/test/resources"),
                new File("$projectDir/src/main/webapp/WEB-INF/")]

    //创建项目目录结构
    task('creadirs',{
        dirs.each({
            if(!it.exists())
            {
                it.mkdirs()
                println("creadirs new $it.path")
            }
            else
            {
                println("creadirs exists $it.path")
            }
        })
    })
})